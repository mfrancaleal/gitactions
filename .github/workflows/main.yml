name: Laravel Workflows
on: push

jobs:
  build:
    name: Laravel/GraphQl Build
    runs-on: ubuntu-20.04
    env:
      working-directory: ./graphql 
    steps:
      - uses: actions/checkout@master
      - uses: ./.github/actions/composer
      - uses: ./.github/actions/config-laravel
      - run: ./vendor/bin/phpunit
      - run: ./vendor/bin/phpcs
      - uses: kamilkisiela/graphql-inspector@master
        working-directory: ${{ env.working-directory  }} 
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          schema: 'main:schema.graphql'
  